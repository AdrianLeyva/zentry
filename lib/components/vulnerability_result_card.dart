import 'package:flutter/material.dart';
import 'package:zentry/modules/network_scanner/models/vulnerability.dart';

import '../core/ui/generic_card.dart';

class VulnerabilityResultCard extends StatelessWidget {
  final Vulnerability vulnerability;

  const VulnerabilityResultCard({super.key, required this.vulnerability});

  Color _severityColor(String severity) {
    switch (severity.toLowerCase()) {
      case 'critical':
        return Colors.red.shade700;
      case 'high':
        return Colors.orange;
      case 'medium':
        return Colors.amber;
      case 'low':
        return Colors.green;
      default:
        return Colors.grey;
    }
  }

  @override
  Widget build(BuildContext context) {
    return GenericCard(
      color: _severityColor(vulnerability.severity).withOpacity(0.1),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(
            "${vulnerability.ip}:${vulnerability.port}",
            style: Theme.of(context)
                .textTheme
                .titleMedium
                ?.copyWith(fontWeight: FontWeight.bold),
          ),
          const SizedBox(height: 8),
          Text(vulnerability.description),
          const SizedBox(height: 4),
          Text(
            "Severity: ${vulnerability.severity.toUpperCase()}",
            style: TextStyle(
              color: _severityColor(vulnerability.severity),
              fontWeight: FontWeight.bold,
            ),
          ),
        ],
      ),
    );
  }
}
