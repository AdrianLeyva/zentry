import 'package:zentry/modules/network_scanner/models/vulnerability.dart';

extension VulnerabilityExtensions on List<Vulnerability> {
  String toSummaryString() {
    if (isEmpty) return 'No vulnerabilities detected.';

    final buffer = StringBuffer();
    buffer.writeln('Detected Vulnerabilities Summary:');
    for (final vuln in this) {
      buffer.writeln(
          '- IP: ${vuln.ip}, Port: ${vuln.port}, Severity: ${vuln.severity}');
      buffer.writeln('  Description: ${vuln.description}');
      buffer.writeln('');
    }
    return buffer.toString();
  }
}
