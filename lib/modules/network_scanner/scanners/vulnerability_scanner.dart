import '../models/vulnerability.dart';

class VulnerabilityScanner {
  List<Vulnerability> analyze(String ip, List<int> openPorts) {
    List<Vulnerability> vulnerabilities = [];

    for (final port in openPorts) {
      if (port == 21) {
        vulnerabilities.add(Vulnerability(
            ip: ip,
            port: port,
            description: 'FTP sin cifrado',
            severity: 'high'));
      } else if (port == 23) {
        vulnerabilities.add(Vulnerability(
            ip: ip,
            port: port,
            description: 'Telnet expuesto',
            severity: 'high'));
      } else if (port == 445) {
        vulnerabilities.add(Vulnerability(
            ip: ip,
            port: port,
            description: 'SMB expuesto (puede permitir RCE)',
            severity: 'critical'));
      }
    }

    return vulnerabilities;
  }
}
